<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart - LunaLuxe</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/cart.css">
    <link rel="stylesheet" href="css/moon-bg.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <div class="moon-bg-animated">
        <div class="moon"></div>
        <div class="star" style="top:12vh;left:20vw;width:3px;height:3px;animation-delay:0.2s;"></div>
        <div class="star" style="top:18vh;left:80vw;width:2px;height:2px;animation-delay:0.7s;"></div>
        <div class="star" style="top:30vh;left:60vw;width:2.5px;height:2.5px;animation-delay:1.1s;"></div>
        <div class="star" style="top:50vh;left:40vw;width:2px;height:2px;animation-delay:0.4s;"></div>
        <div class="star" style="top:70vh;left:70vw;width:3px;height:3px;animation-delay:1.5s;"></div>
        <div class="star" style="top:80vh;left:10vw;width:2px;height:2px;animation-delay:0.9s;"></div>
        <div class="star" style="top:90vh;left:90vw;width:2.5px;height:2.5px;animation-delay:1.8s;"></div>
    </div>
    <!-- Main Header -->
    <div class="main-header fade-in">
        <div class="logo"><img src="images/logo 1.png" alt="LunaLuxe - Home Logo"><span></span></div>
        <nav class="main-nav" aria-label="Main navigation">
            <ul>
                <li><a href="index.html" class="active">Home</a></li>
                <li><a href="shop.html">Shop</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="customer-service.html">Customer Service</a></li>
                <li><a href="#" id="faq-link" aria-haspopup="dialog" aria-controls="faq-modal">FAQ</a></li>
            </ul>
        </nav>
        <div class="header-actions">
            <a href="#" class="search-icon" aria-label="Open search"><i class="fas fa-search"></i></a>
            <a href="cart.html" class="cart-icon" aria-label="View cart">
                <i class="fas fa-shopping-basket"></i>
                <span class="cart-count">0</span>
            </a>
        </div>
    </div>

    <main class="cart-container">
        <h1>Your Shopping Cart</h1>
        <div class="cart-actions">
            <button id="clearCartBtn" class="btn-secondary" aria-label="Clear cart">Clear Cart</button>
            <a href="shop.html" class="btn-secondary">Continue Shopping</a>
        </div>
        <div class="cart-content">
            <div class="cart-items" id="cartItems"></div>
            <aside class="order-summary">
                <h2>Order Summary</h2>
                <div class="summary-details">
                    <div class="summary-row"><span>Subtotal</span><span id="cartSubtotal">KSh 0.00</span></div>
                    <div class="summary-row"><span>Shipping</span><span id="cartShipping">KSh 0.00</span></div>
                    <div class="summary-row"><span>Tax (16% VAT)</span><span id="cartTax">KSh 0.00</span></div>
                    <div class="summary-row total"><span>Total</span><span id="cartTotal">KSh 0.00</span></div>
                </div>
                <button id="checkoutBtn" class="btn-primary" aria-label="Proceed to Checkout">Proceed to Checkout</button>
            </aside>
        </div>
    </main>
    <div id="removeConfirmModal" class="modal" style="display:none;">
        <div class="modal-content">
            <p>Are you sure you want to remove this item?</p>
            <button id="confirmRemoveBtn" class="btn-primary">Yes, Remove</button>
            <button id="cancelRemoveBtn" class="btn-secondary">Cancel</button>
        </div>
    </div>
    <div id="clearCartConfirmModal" class="modal" style="display:none;">
        <div class="modal-content">
            <p>Are you sure you want to clear your cart?</p>
            <button id="confirmClearCartBtn" class="btn-primary">Yes, Clear</button>
            <button id="cancelClearCartBtn" class="btn-secondary">Cancel</button>
        </div>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        function renderCart() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartItemsContainer = document.getElementById('cartItems');
            const cartSubtotal = document.getElementById('cartSubtotal');
            const cartShipping = document.getElementById('cartShipping');
            const cartTax = document.getElementById('cartTax');
            const cartTotal = document.getElementById('cartTotal');
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<div class="empty-cart-message"><i class="fas fa-shopping-cart"></i><p>Your cart is empty</p><a href="shop.html" class="btn-primary">Continue Shopping</a></div>';
                cartSubtotal.textContent = 'KSh 0.00';
                cartShipping.textContent = 'KSh 0.00';
                cartTax.textContent = 'KSh 0.00';
                cartTotal.textContent = 'KSh 0.00';
                return;
            }
            let subtotal = 0;
            cartItemsContainer.innerHTML = cart.map((item, idx) => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                return `<div class="cart-item" data-index="${idx}">
                    <img src="${item.image}" alt="${item.name}" class="cart-item-img">
                    <div class="cart-item-info">
                        <span class="cart-item-name">${item.name}</span>
                        <span class="cart-item-options">
                            ${item.color ? `<span class='item-color' style='display:inline-block;vertical-align:middle;min-width:18px;min-height:18px;border-radius:50%;background:${item.color};border:1px solid #ccc;margin-right:6px;' title='${item.color}'></span> <span>${item.color}</span>` : ''}
                            ${item.size ? `<span class='item-size'>Size: ${item.size}</span>` : ''}
                        </span>
                        <span class="cart-item-price">KSh ${item.price.toFixed(2)}</span>
                        <div class="cart-item-qty">
                            <button class="qty-btn decrease" aria-label="Decrease quantity">-</button>
                            <input type="number" min="1" value="${item.quantity}" class="qty-input">
                            <button class="qty-btn increase" aria-label="Increase quantity">+</button>
                        </div>
                    </div>
                    <span class="cart-item-total">KSh ${(itemTotal).toFixed(2)}</span>
                    <button class="remove-item-btn" aria-label="Remove item from cart"><i class="fas fa-times"></i></button>
                </div>`;
            }).join('');
            const shipping = subtotal > 5000 ? 0 : 300;
            const tax = subtotal * 0.16;
            const total = subtotal + shipping + tax;
            cartSubtotal.textContent = `KSh ${subtotal.toFixed(2)}`;
            cartShipping.textContent = `KSh ${shipping.toFixed(2)}`;
            cartTax.textContent = `KSh ${tax.toFixed(2)}`;
            cartTotal.textContent = `KSh ${total.toFixed(2)}`;
        }
        renderCart();
        document.getElementById('cartItems').addEventListener('click', function(e) {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const itemDiv = e.target.closest('.cart-item');
            if (!itemDiv) return;
            const idx = parseInt(itemDiv.getAttribute('data-index'));
            if (e.target.classList.contains('qty-btn')) {
                if (e.target.classList.contains('decrease')) {
                    if (cart[idx].quantity > 1) cart[idx].quantity--;
                } else if (e.target.classList.contains('increase')) {
                    cart[idx].quantity++;
                }
                localStorage.setItem('cart', JSON.stringify(cart));
                renderCart();
            } else if (e.target.classList.contains('remove-item-btn') || e.target.closest('.remove-item-btn')) {
                const removeModal = document.getElementById('removeConfirmModal');
                removeModal.style.display = 'block';
                document.getElementById('confirmRemoveBtn').onclick = function() {
                    cart.splice(idx, 1);
                    localStorage.setItem('cart', JSON.stringify(cart));
                    removeModal.style.display = 'none';
                    renderCart();
                };
                document.getElementById('cancelRemoveBtn').onclick = function() {
                    removeModal.style.display = 'none';
                };
            }
        });
        document.getElementById('cartItems').addEventListener('change', function(e) {
            if (e.target.classList.contains('qty-input')) {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                const itemDiv = e.target.closest('.cart-item');
                const idx = parseInt(itemDiv.getAttribute('data-index'));
                let val = parseInt(e.target.value);
                if (isNaN(val) || val < 1) val = 1;
                cart[idx].quantity = val;
                localStorage.setItem('cart', JSON.stringify(cart));
                renderCart();
            }
        });
        document.getElementById('clearCartBtn').onclick = function() {
            const clearModal = document.getElementById('clearCartConfirmModal');
            clearModal.style.display = 'block';
            document.getElementById('confirmClearCartBtn').onclick = function() {
                localStorage.removeItem('cart');
                clearModal.style.display = 'none';
                renderCart();
            };
            document.getElementById('cancelClearCartBtn').onclick = function() {
                clearModal.style.display = 'none';
            };
        };
        document.getElementById('checkoutBtn').onclick = function() {
            window.location.href = 'checkout.html';
        };
    });
    </script>
</body>
</html>
